2025-03-31 11:25:16,890 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-03-31 11:25:16,890 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-03-31 11:25:16,892 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:25:20,172 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:25:20,179 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:25:28,346 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:25:28] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:25:30,369 - app.services - INFO - Descargando archivo: uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:25:31,186 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv "HTTP/2 400 Bad Request"
2025-03-31 11:25:31,192 - app.services - ERROR - Error inesperado al descargar archivo: {'statusCode': 404, 'error': not_found, 'message': Object not found}
Traceback (most recent call last):
  File "C:\Python312\Lib\site-packages\storage3\_sync\file_api.py", line 53, in _request
    response.raise_for_status()
  File "C:\Python312\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\services.py", line 80, in download_file
    response = supabase.storage.from_("uploads").create_signed_url(clean_path, 3600)  # 1 hora de validez
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\storage3\_sync\file_api.py", line 182, in create_signed_url
    response = self._request(
               ^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\storage3\_sync\file_api.py", line 56, in _request
    raise StorageApiError(resp["message"], resp["error"], resp["statusCode"])
storage3.exceptions.StorageApiError: {'statusCode': 404, 'error': not_found, 'message': Object not found}

2025-03-31 11:25:31,288 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:25:31] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 11:26:54,657 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 11:26:55,255 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:26:58,924 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:26:58,928 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:29:00,519 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:29:01,008 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:29:04,721 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:29:04,725 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:29:12,450 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:29:12] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:29:14,350 - app.services - INFO - Intentando descargar archivo: 12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:29:14,651 - app.services - INFO - URL pública generada: https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/public/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv?
2025-03-31 11:29:15,260 - app.services - ERROR - Error al descargar archivo. Código de estado: 400
2025-03-31 11:29:15,373 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:29:15] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 11:29:47,963 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:29:48,407 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:29:51,929 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:29:51,933 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:30:19,073 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:30:19,522 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:30:22,866 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:30:22,870 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:30:42,444 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:30:42] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:30:44,455 - app.services - INFO - Intentando descargar archivo: 12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:30:44,744 - app.services - INFO - URL pública generada: https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/public/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv?
2025-03-31 11:30:45,259 - app.services - ERROR - Error al descargar archivo. Código de estado: 400
2025-03-31 11:30:45,259 - app.routes - ERROR - Error al descargar: Error al descargar archivo. Código de estado: 400
2025-03-31 11:30:45,357 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:30:45] "[31m[1mPOST /api/create-pdf HTTP/1.1[0m" 400 -
2025-03-31 11:32:11,433 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 11:32:12,023 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:32:16,147 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:32:16,152 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:36:51,995 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:36:51] "POST /upload HTTP/1.1" 200 -
2025-03-31 11:38:40,805 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:38:40] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:38:41,039 - app.services - INFO - Intentando descargar archivo: 12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:38:42,003 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv "HTTP/2 400 Bad Request"
2025-03-31 11:38:42,003 - app.services - ERROR - Error al generar URL firmada: {'statusCode': 404, 'error': not_found, 'message': Object not found}
2025-03-31 11:38:42,003 - app.services - INFO - Usando URL pública como fallback: https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/public/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv?
2025-03-31 11:38:42,595 - app.services - ERROR - Error al descargar archivo. Código de estado: 400
2025-03-31 11:38:42,596 - app.routes - ERROR - Error al descargar: Error al descargar archivo. Código de estado: 400
2025-03-31 11:38:42,765 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:38:42] "[31m[1mPOST /api/create-pdf HTTP/1.1[0m" 400 -
2025-03-31 11:41:10,769 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:41:11,294 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:41:14,498 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:41:14,504 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:41:17,530 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:41:17,936 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:41:20,991 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:41:20,994 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:41:23,017 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:41:23,338 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:41:26,407 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:41:26,411 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:41:27,430 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:41:27,832 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:43:21,128 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-03-31 11:43:21,129 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-03-31 11:43:21,132 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:43:23,999 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:43:24,002 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:43:31,904 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:43:31] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:43:33,911 - app.services - INFO - Intentando descargar archivo: 12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:43:34,732 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv "HTTP/2 400 Bad Request"
2025-03-31 11:43:34,734 - app.services - ERROR - Error al generar URL firmada: {'statusCode': 404, 'error': not_found, 'message': Object not found}
2025-03-31 11:43:34,734 - app.services - INFO - Usando URL pública como fallback: https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/public/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv?
2025-03-31 11:43:35,218 - app.services - ERROR - Error al descargar archivo. Código de estado: 400
2025-03-31 11:43:35,218 - app.routes - ERROR - Error al descargar archivo fuente: Error al descargar archivo. Código de estado: 400
2025-03-31 11:43:35,218 - app.services - INFO - Procesando archivo: downloads\Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:43:35,582 - app.services - ERROR - Error al procesar archivo: [Errno 2] No such file or directory: 'downloads\\Ejemplo_de_archivos_a_subir_en_sistema_2.csv'
Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\services.py", line 133, in process_file
    df_original = pd.read_csv(input_file, delimiter=";")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'downloads\\Ejemplo_de_archivos_a_subir_en_sistema_2.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\services.py", line 135, in process_file
    df_original = pd.read_csv(input_file, delimiter=",")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'downloads\\Ejemplo_de_archivos_a_subir_en_sistema_2.csv'

2025-03-31 11:43:35,582 - app.routes - ERROR - Error al procesar archivo: [Errno 2] No such file or directory: 'downloads\\Ejemplo_de_archivos_a_subir_en_sistema_2.csv'
2025-03-31 11:43:35,686 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:43:35] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 11:45:23,585 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 11:45:24,223 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:45:27,543 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:45:27,547 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:45:51,682 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:45:52,156 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:46:20,976 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-03-31 11:46:20,977 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-03-31 11:46:20,979 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:46:23,901 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:46:23,904 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:46:32,068 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:46:32] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:46:34,938 - app.services - INFO - Iniciando descarga de: 12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:46:34,939 - app.services - INFO - Intentando con URL firmada...
2025-03-31 11:46:35,878 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv "HTTP/2 400 Bad Request"
2025-03-31 11:46:35,879 - app.services - WARNING - Error con URL firmada: {'statusCode': 404, 'error': not_found, 'message': Object not found}
2025-03-31 11:46:35,879 - app.services - INFO - Intentando con URL pública...
2025-03-31 11:46:36,355 - app.services - ERROR - Error con URL pública: Status code: 400
2025-03-31 11:46:36,355 - app.services - INFO - Intentando descarga directa...
2025-03-31 11:46:36,801 - httpx - INFO - HTTP Request: GET https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv "HTTP/2 400 Bad Request"
2025-03-31 11:46:36,802 - app.services - ERROR - Error en descarga directa: {'statusCode': 404, 'error': not_found, 'message': Object not found}
2025-03-31 11:46:36,802 - app.services - ERROR - No se pudo descargar el archivo después de 3 intentos
2025-03-31 11:46:36,802 - app.services - INFO - Iniciando descarga de: uploads/12345/Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:46:36,804 - app.services - INFO - Archivo encontrado en caché local: downloads\Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:46:36,804 - app.services - INFO - Procesando archivo: downloads\Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 11:46:37,140 - app.services - ERROR - Error al procesar archivo: No columns to parse from file
Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\services.py", line 152, in process_file
    df_original = pd.read_csv(input_file, delimiter=";")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\services.py", line 154, in process_file
    df_original = pd.read_csv(input_file, delimiter=",")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

2025-03-31 11:46:37,244 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:46:37] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 11:47:47,484 - app.services - INFO - Intentando subir archivo: uploads\Libro1_1.xlsx a uploads/12345/Libro1_1.xlsx
2025-03-31 11:47:48,372 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/uploads/12345/Libro1_1.xlsx "HTTP/2 200 OK"
2025-03-31 11:47:48,373 - app.services - INFO - Archivo subido exitosamente: 12345/Libro1_1.xlsx
2025-03-31 11:47:48,596 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:47:48] "POST /upload HTTP/1.1" 200 -
2025-03-31 11:47:58,597 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:47:58] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:47:58,793 - app.services - INFO - Iniciando descarga de: 12345/Libro1_1.xlsx
2025-03-31 11:47:58,793 - app.services - INFO - Intentando con URL firmada...
2025-03-31 11:47:59,064 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Libro1_1.xlsx "HTTP/2 200 OK"
2025-03-31 11:47:59,589 - app.services - INFO - Descarga exitosa via URL firmada: downloads\Libro1_1.xlsx
2025-03-31 11:47:59,591 - app.services - INFO - Procesando archivo: downloads\Libro1_1.xlsx
2025-03-31 11:48:00,180 - app.services - INFO - Archivo procesado exitosamente: downloads\archivo_convertido.csv
2025-03-31 11:48:00,181 - app.services - INFO - Creando PDF desde: downloads\archivo_convertido.csv
2025-03-31 11:48:00,194 - app.services - INFO - PDF creado exitosamente: downloads\12345_20250331_114800_order.pdf
2025-03-31 11:48:00,194 - app.services - INFO - Intentando subir archivo: downloads\12345_20250331_114800_order.pdf a pdf/12345/12345_20250331_114800_order.pdf
2025-03-31 11:48:00,551 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/uploads/pdf/12345/12345_20250331_114800_order.pdf "HTTP/2 200 OK"
2025-03-31 11:48:00,552 - app.services - INFO - Archivo subido exitosamente: pdf/12345/12345_20250331_114800_order.pdf
2025-03-31 11:48:01,327 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:48:01] "POST /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:48:45,575 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:48:45] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:48:45,815 - app.services - INFO - Iniciando descarga de: 12345/12345_20250331_114800_order.pdf
2025-03-31 11:48:45,815 - app.services - INFO - Archivo encontrado en caché local: downloads\12345_20250331_114800_order.pdf
2025-03-31 11:48:45,816 - app.services - INFO - Procesando archivo: downloads\12345_20250331_114800_order.pdf
2025-03-31 11:48:45,816 - app.services - ERROR - Formato de archivo no soportado
2025-03-31 11:48:45,922 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:48:45] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 11:54:17,243 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 11:54:17,764 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:54:21,317 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:54:21,322 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:55:09,571 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:55:10,160 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:55:13,401 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:55:13,404 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:55:18,442 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\models.py', reloading
2025-03-31 11:55:18,850 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:55:21,648 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:55:21,651 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:56:01,857 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:56:02,309 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:56:05,663 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:56:05,667 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:56:20,755 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:56:21,185 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:56:24,181 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:56:24,184 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:58:54,911 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 11:58:55,506 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:58:59,079 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:58:59,083 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:59:19,198 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 11:59:19,506 - werkzeug - INFO -  * Restarting with stat
2025-03-31 11:59:22,656 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 11:59:22,661 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 11:59:39,681 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:59:39] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 11:59:41,649 - app.routes - ERROR - Error en generate_pdf: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s ORDER BY user_files.id DESC 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\routes.py", line 233, in generate_pdf
    user_file = UserFiles.query.filter_by(user_id=user_id).order_by(UserFiles.id.desc()).first()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2247, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s ORDER BY user_files.id DESC 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-31 11:59:41,651 - app.routes - ERROR - Error en generate_pdf: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s ORDER BY user_files.id DESC 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\routes.py", line 233, in generate_pdf
    user_file = UserFiles.query.filter_by(user_id=user_id).order_by(UserFiles.id.desc()).first()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2247, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s ORDER BY user_files.id DESC 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-31 11:59:41,750 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:59:41] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 11:59:41,750 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 11:59:41] "[35m[1mPOST /api/create-pdf HTTP/1.1[0m" 500 -
2025-03-31 12:01:35,293 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\models.py', reloading
2025-03-31 12:01:35,832 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:01:39,127 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 12:01:39,130 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 12:05:13,226 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:05:13] "OPTIONS /api/create-pdf HTTP/1.1" 200 -
2025-03-31 12:05:15,324 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:05:15] "[33mPOST /api/create-pdf HTTP/1.1[0m" 404 -
2025-03-31 12:07:52,201 - app.services - INFO - Intentando subir archivo: uploads\Libro1.xlsx a 12345/Libro1.xlsx
2025-03-31 12:07:53,046 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/uploads/12345/Libro1.xlsx "HTTP/2 200 OK"
2025-03-31 12:07:53,047 - app.services - INFO - Archivo subido exitosamente: 12345/Libro1.xlsx
2025-03-31 12:07:53,255 - app.services - INFO - Iniciando descarga de: 12345/Libro1.xlsx
2025-03-31 12:07:53,255 - app.services - INFO - Intentando con URL firmada...
2025-03-31 12:07:53,560 - httpx - INFO - HTTP Request: POST https://ieujngazvobampsyaiqo.supabase.co/storage/v1/object/sign/uploads/12345/Libro1.xlsx "HTTP/2 200 OK"
2025-03-31 12:07:53,981 - app.services - INFO - Descarga exitosa via URL firmada: downloads\Libro1.xlsx
2025-03-31 12:07:53,981 - app.services - INFO - Procesando archivo: downloads\Libro1.xlsx
2025-03-31 12:07:54,381 - app.services - INFO - Archivo procesado exitosamente: downloads\archivo_convertido.csv
2025-03-31 12:07:55,014 - app.services - ERROR - Error en create_pdf: asUnicode(None,enc='utf8') error:  'NoneType' object has no attribute 'decode'
Traceback (most recent call last):
  File "C:\Python312\Lib\site-packages\reportlab\lib\utils.py", line 70, in asUnicode
    return v.decode(enc)
           ^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'decode'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\services.py", line 191, in create_pdf
    c.drawString(margin, current_y, form_data.get('company_name', 'COMPAÑÍA'))
  File "C:\Python312\Lib\site-packages\reportlab\pdfgen\canvas.py", line 1624, in drawString
    text, width = self.shapedText(text)
                  ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\reportlab\pdfgen\canvas.py", line 1614, in shapedText
    text = asUnicode(text)
           ^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\reportlab\lib\utils.py", line 72, in asUnicode
    annotateException('asUnicode(%s,enc=%s) error: ' % (ascii(v),ascii(enc)))
  File "C:\Python312\Lib\site-packages\reportlab\lib\utils.py", line 1176, in annotateException
    rl_reraise(t,t(sep.join((_ for _ in (msg,str(v),postMsg) if _))),b)
  File "C:\Python312\Lib\site-packages\reportlab\lib\utils.py", line 138, in rl_reraise
    raise v.with_traceback(b)
  File "C:\Python312\Lib\site-packages\reportlab\lib\utils.py", line 70, in asUnicode
    return v.decode(enc)
           ^^^^^^^^
AttributeError: asUnicode(None,enc='utf8') error:  'NoneType' object has no attribute 'decode'

2025-03-31 12:07:55,015 - app.routes - ERROR - Error al generar PDF para Libro1.xlsx: asUnicode(None,enc='utf8') error:  'NoneType' object has no attribute 'decode'
2025-03-31 12:07:55,019 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:07:55] "POST /upload HTTP/1.1" 200 -
2025-03-31 12:08:43,177 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:08:43] "POST /upload HTTP/1.1" 200 -
2025-03-31 12:12:28,254 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 12:12:28,949 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:12:32,452 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 12:12:32,456 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 12:12:52,726 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:12:52] "POST /upload HTTP/1.1" 200 -
2025-03-31 12:16:34,352 - app.routes - ERROR - Error en upload_files: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s AND user_files.filename = %(filename_1)s 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'filename_1': 'Libro1.xlsx', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\routes.py", line 83, in upload_files
    if UserFiles.query.filter_by(user_id=user_id, filename=filename).first():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2247, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s AND user_files.filename = %(filename_1)s 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'filename_1': 'Libro1.xlsx', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-31 12:16:34,449 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:16:34] "[35m[1mPOST /upload HTTP/1.1[0m" 500 -
2025-03-31 12:16:51,567 - app.routes - ERROR - Error en upload_files: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s AND user_files.filename = %(filename_1)s 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'filename_1': 'Libro1.xlsx', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Mario Ramón\8to semestre\Backend-chamba2\project\app\routes.py", line 83, in upload_files
    if UserFiles.query.filter_by(user_id=user_id, filename=filename).first():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 2247, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column user_files.parent_file_id does not exist
LINE 1: ...user_files.uploaded_at AS user_files_uploaded_at, user_files...
                                                             ^

[SQL: SELECT user_files.id AS user_files_id, user_files.user_id AS user_files_user_id, user_files.filename AS user_files_filename, user_files.file_type AS user_files_file_type, user_files.file_path AS user_files_file_path, user_files.uploaded_at AS user_files_uploaded_at, user_files.parent_file_id AS user_files_parent_file_id 
FROM user_files 
WHERE user_files.user_id = %(user_id_1)s AND user_files.filename = %(filename_1)s 
 LIMIT %(param_1)s]
[parameters: {'user_id_1': '12345', 'filename_1': 'Libro1.xlsx', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-31 12:16:51,663 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 12:16:51] "[35m[1mPOST /upload HTTP/1.1[0m" 500 -
2025-03-31 12:17:27,929 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 12:17:28,517 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:17:31,623 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 12:17:31,628 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 12:17:46,708 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\routes.py', reloading
2025-03-31 12:17:47,124 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:17:50,183 - app.services - INFO - Archivo eliminado por antigüedad: 12345_20250331_114800_order.pdf
2025-03-31 12:17:50,184 - app.services - INFO - Archivo eliminado por antigüedad: Ejemplo_de_archivos_a_subir_en_sistema_2.csv
2025-03-31 12:17:50,184 - app.services - INFO - Archivo eliminado por antigüedad: Libro1_1.xlsx
2025-03-31 12:17:50,209 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 12:17:50,213 - werkzeug - INFO -  * Debugger PIN: 469-648-210
2025-03-31 12:18:12,332 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Mario Ramón\\8to semestre\\Backend-chamba2\\project\\app\\services.py', reloading
2025-03-31 12:18:12,758 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:18:23,212 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:18:32,486 - werkzeug - INFO -  * Restarting with stat
2025-03-31 12:18:37,244 - werkzeug - INFO -  * Restarting with stat
